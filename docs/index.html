<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Heating Project Calculator</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 sticky-header mb-2 pt-2">
                <h2 class="text-center">Bitcoin Heating Project - Калькулятор</h2>
                <ul class="nav nav-tabs" id="projectTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="input-tab" data-bs-toggle="tab" data-bs-target="#input"
                          type="button" role="tab" aria-controls="input" aria-selected="true">Исходные данные</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="report-tab" data-bs-toggle="tab" data-bs-target="#report"
                          type="button" role="tab" aria-controls="report" aria-selected="false">Отчет</button>
                    </li>
                </ul>
            </div>
        </div>

        <div class="tab-content" id="projectTabsContent">
            <!-- Вкладка с формой ввода данных -->
            <div class="tab-pane fade show active" id="input" role="tabpanel" aria-labelledby="input-tab">
                <form id="projectDataForm">
                    <div class="row">
                        <div class="col-md-6">
                            <!-- Капитальные затраты (CAPEX) -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>Капитальные затраты (CAPEX)</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <label for="generatorPower" class="col-sm-7 col-form-label">Мощность газопоршневого генератора (МВт)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="generatorPower" name="generatorPower" value="2.2">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="generatorCost" class="col-sm-7 col-form-label">Стоимость газопоршневого генератора (руб.)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="generatorCost" name="generatorCost" value="75000000">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="heatUtilizationCost" class="col-sm-7 col-form-label">Стоимость системы утилизации тепла (руб.)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="heatUtilizationCost" name="heatUtilizationCost" value="18859764">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="chillerPower" class="col-sm-7 col-form-label">Мощность абсорбционного холодильника (МВт)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="chillerPower" name="chillerPower" value="2">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="chillerCost" class="col-sm-7 col-form-label">Стоимость абсорбционного холодильника (руб.)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="chillerCost" name="chillerCost" value="75000000">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="coolingTowersPower" class="col-sm-7 col-form-label">Мощность градирен (МВт)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="coolingTowersPower" name="coolingTowersPower" value="4.1">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="coolingTowersCost" class="col-sm-7 col-form-label">Стоимость градирен (руб.)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="coolingTowersCost" name="coolingTowersCost" value="50000000">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="controlSystemCost" class="col-sm-7 col-form-label">Стоимость АСУ (руб.)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="controlSystemCost" name="controlSystemCost" value="15000000">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Параметры майнинга -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>Параметры майнинга</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <label for="minerModel" class="col-sm-7 col-form-label">Модель ASIC майнера</label>
                                        <div class="col-sm-5">
                                            <input type="text" class="form-control" id="minerModel" name="minerModel" value="S19 XP+ Hyd">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="hashRate" class="col-sm-7 col-form-label">Хешрейт одного майнера (TH/s)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="hashRate" name="hashRate" value="279">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="minerPower" class="col-sm-7 col-form-label">Энергопотребление одного майнера (Вт)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="minerPower" name="minerPower" value="5301">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="minerCost" class="col-sm-7 col-form-label">Стоимость одного майнера (руб.)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="minerCost" name="minerCost" value="301000">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="minerCount" class="col-sm-7 col-form-label">Количество майнеров (шт)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="minerCount" name="minerCount" value="377">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="genEfficiencyElec" class="col-sm-7 col-form-label">КПД генератора по электричеству (%)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="genEfficiencyElec" name="genEfficiencyElec" value="40">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="genEfficiencyHeat" class="col-sm-7 col-form-label">КПД генератора по теплу (%)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="genEfficiencyHeat" name="genEfficiencyHeat" value="80">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="gasConsumption" class="col-sm-7 col-form-label">Расход газа (м³/кВт·ч)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.01" class="form-control" id="gasConsumption" name="gasConsumption" value="0.3">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="asicHeatRecovery" class="col-sm-7 col-form-label">Утилизация тепла от асиков (%)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="1" class="form-control" id="asicHeatRecovery" name="asicHeatRecovery" value="90">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="maintenancePercent" class="col-sm-7 col-form-label">Обслуживание системы (% от CAPEX в год)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="maintenancePercent" name="maintenancePercent" value="5">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="additionalTaxes" class="col-sm-7 col-form-label">Дополнительные налоги (руб. в год)</label>
                                        <div class="col-sm-5">
                                            <input type="number" class="form-control" id="additionalTaxes" name="additionalTaxes" value="0">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="defaultInflation" class="col-sm-7 col-form-label">Инфляция (%)</label>
                                        <div class="col-sm-5">
                                            <input type="number" step="0.1" class="form-control" id="defaultInflation" name="defaultInflation" value="10">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <!-- Параметры по годам -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>Прогнозные показатели на 7 лет</h5>
                                </div>
                                <div class="card-body">
                                    <div class="d-md-none mb-3">
                                        <label for="yearSelector" class="form-label">Выберите год для просмотра:</label>
                                        <select class="form-select mb-2 year-selector" id="yearSelector">
                                            <option value="all">Все годы</option>
                                            <option value="1">Год 1</option>
                                            <option value="2">Год 2</option>
                                            <option value="3">Год 3</option>
                                            <option value="4">Год 4 (халвинг)</option>
                                            <option value="5">Год 5</option>
                                            <option value="6">Год 6</option>
                                            <option value="7">Год 7</option>
                                        </select>
                                    </div>
                                    <div class="d-md-none table-scroll-hint">
                                        <span class="scroll-icon">⟷</span> Прокрутите таблицу для просмотра всех данных
                                    </div>
                                    <div class="table-wrapper">
                                        <table class="table table-sm table-hover" id="yearlyParamsTable">
                                            <thead>
                                                <tr>
                                                    <th class="sticky-year-column">Параметр</th>
                                                    <th class="year-column year-1">Год 1</th>
                                                    <th class="year-column year-2">Год 2</th>
                                                    <th class="year-column year-3">Год 3</th>
                                                    <th class="year-column year-4 halving-year">Год 4</th>
                                                    <th class="year-column year-5">Год 5</th>
                                                    <th class="year-column year-6">Год 6</th>
                                                    <th class="year-column year-7">Год 7</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="sticky-year-column">Цена Bitcoin (руб.) <span class="custom-tooltip">ⓘ
                                                        <span class="tooltip-text">Прогнозируемая цена Bitcoin в рублях</span>
                                                    </span></td>
                                                    <td class="year-column year-1"><input type="number" class="form-control form-control-sm" name="btcPrice_1" value="6000000"></td>
                                                    <td class="year-column year-2"><input type="number" class="form-control form-control-sm" name="btcPrice_2" value="7000000"></td>
                                                    <td class="year-column year-3"><input type="number" class="form-control form-control-sm" name="btcPrice_3" value="8000000"></td>
                                                    <td class="halving-year year-column year-4"><input type="number" class="form-control form-control-sm" name="btcPrice_4" value="12000000"></td>
                                                    <td class="year-column year-5"><input type="number" class="form-control form-control-sm" name="btcPrice_5" value="13000000"></td>
                                                    <td class="year-column year-6"><input type="number" class="form-control form-control-sm" name="btcPrice_6" value="14000000"></td>
                                                    <td class="year-column year-7"><input type="number" class="form-control form-control-sm" name="btcPrice_7" value="15000000"></td>
                                                </tr>
                                                <tr>
                                                    <td class="sticky-year-column">Сложность майнинга (прирост %) <span class="custom-tooltip">ⓘ
                                                        <span class="tooltip-text">Прогнозируемый годовой прирост сложности сети Bitcoin в процентах</span>
                                                    </span></td>
                                                    <td class="year-column year-1"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_1" value="5"></td>
                                                    <td class="year-column year-2"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_2" value="10"></td>
                                                    <td class="year-column year-3"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_3" value="15"></td>
                                                    <td class="halving-year year-column year-4"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_4" value="20"></td>
                                                    <td class="year-column year-5"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_5" value="25"></td>
                                                    <td class="year-column year-6"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_6" value="30"></td>
                                                    <td class="year-column year-7"><input type="number" class="form-control form-control-sm" name="difficultyGrowth_7" value="35"></td>
                                                </tr>
                                                <tr>
                                                    <td class="sticky-year-column">Цена газа (руб./м³) <span class="custom-tooltip">ⓘ
                                                        <span class="tooltip-text">Прогнозируемая цена на газ в рублях за кубический метр</span>
                                                    </span></td>
                                                    <td class="year-column year-1"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_1" value="6.5"></td>
                                                    <td class="year-column year-2"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_2" value="7"></td>
                                                    <td class="year-column year-3"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_3" value="7.5"></td>
                                                    <td class="halving-year year-column year-4"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_4" value="8"></td>
                                                    <td class="year-column year-5"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_5" value="8.5"></td>
                                                    <td class="year-column year-6"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_6" value="9"></td>
                                                    <td class="year-column year-7"><input type="number" step="0.01" class="form-control form-control-sm" name="gasPrice_7" value="9.5"></td>
                                                </tr>
                                                <tr>
                                                    <td class="sticky-year-column">Цена тепла (руб./Гкал) <span class="custom-tooltip">ⓘ
                                                        <span class="tooltip-text">Прогнозируемая цена реализации тепла в рублях за гигакалорию</span>
                                                    </span></td>
                                                    <td class="year-column year-1"><input type="number" class="form-control form-control-sm" name="heatPrice_1" value="2500"></td>
                                                    <td class="year-column year-2"><input type="number" class="form-control form-control-sm" name="heatPrice_2" value="2750"></td>
                                                    <td class="year-column year-3"><input type="number" class="form-control form-control-sm" name="heatPrice_3" value="3025"></td>
                                                    <td class="halving-year year-column year-4"><input type="number" class="form-control form-control-sm" name="heatPrice_4" value="3330"></td>
                                                    <td class="year-column year-5"><input type="number" class="form-control form-control-sm" name="heatPrice_5" value="3660"></td>
                                                    <td class="year-column year-6"><input type="number" class="form-control form-control-sm" name="heatPrice_6" value="4025"></td>
                                                    <td class="year-column year-7"><input type="number" class="form-control form-control-sm" name="heatPrice_7" value="4430"></td>
                                                </tr>
                                                <tr>
                                                    <td class="sticky-year-column">Коэффициент использования (%) <span class="custom-tooltip">ⓘ
                                                        <span class="tooltip-text">Процент времени работы системы в течение года</span>
                                                    </span></td>
                                                    <td class="year-column year-1"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_1" value="95"></td>
                                                    <td class="year-column year-2"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_2" value="95"></td>
                                                    <td class="year-column year-3"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_3" value="95"></td>
                                                    <td class="halving-year year-column year-4"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_4" value="95"></td>
                                                    <td class="year-column year-5"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_5" value="95"></td>
                                                    <td class="year-column year-6"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_6" value="95"></td>
                                                    <td class="year-column year-7"><input type="number" step="1" min="1" max="100" class="form-control form-control-sm" name="utilizationRate_7" value="95"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    </div>
                                    <div class="mt-3">
                                        <button type="button" class="btn btn-sm btn-info" id="applyInflation">Применить инфляцию</button>
                                        <small class="text-muted ms-2 d-block mt-1">Желтым отмечен год халвинга</small>
                                    </div>
                                </div>
                            </div>

                            <!-- Кнопки управления -->
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <button type="button" class="btn btn-primary me-2" id="saveDataBtn">Сохранить данные</button>
                                            <button type="button" class="btn btn-secondary" id="loadDataBtn">Загрузить данные</button>
                                        </div>
                                        <button type="button" class="btn btn-success" id="generateReportBtn">Сгенерировать отчет</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Вкладка с отчетом -->
            <div class="tab-pane fade" id="report" role="tabpanel" aria-labelledby="report-tab">
                <div class="d-flex justify-content-end mt-3">
                    <button type="button" class="btn btn-outline-primary me-2" id="copyMarkdownBtn">
                        Скопировать Markdown
                    </button>
                    <button type="button" class="btn btn-outline-success" id="exportPdfBtn">
                        Экспорт в PDF
                    </button>
                </div>
                <div class="preview mt-3" id="reportPreview">
                    <p class="text-muted">Отчет будет отображен здесь после генерации</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Подключаем необходимые JavaScript библиотеки -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="script.js"></script>
</body>
</html>
